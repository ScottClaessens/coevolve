% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/nutpie_helpers.R
\name{nutpie_sample}
\alias{nutpie_sample}
\title{Sample from a Stan model using nutpie}
\usage{
nutpie_sample(
  stan_code,
  data_list,
  num_chains = 4L,
  num_samples = 1000L,
  num_warmup = 500L,
  seed = NULL,
  target_accept = NULL,
  low_rank_modified_mass_matrix = FALSE,
  ...
)
}
\arguments{
\item{stan_code}{Character string containing Stan model code, OR a compiled
nutpie model object.}

\item{data_list}{Named list containing Stan data.}

\item{num_chains}{Integer. Number of chains to run.}

\item{num_samples}{Integer. Number of post-warmup samples per chain.}

\item{num_warmup}{Integer. Number of warmup samples per chain.}

\item{seed}{Integer. Random seed for reproducibility.}

\item{target_accept}{Numeric between 0 and 1. Target acceptance probability
for the NUTS sampler (default: NULL, uses nutpie default of 0.8). This
corresponds to Stan's \code{adapt_delta} parameter.}

\item{low_rank_modified_mass_matrix}{Logical. If \code{TRUE}, enables
low-rank modified mass matrix adaptation for models with strong parameter
correlations (default: \code{FALSE}). This is an experimental feature in
nutpie. When enabled, consider increasing \code{target_accept} (e.g., 0.95
or 0.99) and adjusting \code{mass_matrix_gamma} and
\code{mass_matrix_eigval_cutoff} via \code{...} to reduce divergences.}

\item{...}{Additional arguments passed to \code{nutpie.sample()} or
\code{nutpie.compile_stan_model()} (when \code{stan_code} is a character
string). Useful parameters when using \code{low_rank_modified_mass_matrix =
  TRUE} include: \code{mass_matrix_gamma} (regularization parameter, default
~0.05) and \code{mass_matrix_eigval_cutoff} (eigenvalue cutoff, default
~0.01). For compilation, valid parameters include:
\itemize{
\item \code{extra_stanc_args}: List of strings. Arguments for stanc3
compiler. Example: \code{extra_stanc_args = list("--O1")} for
optimization level 1.
\item \code{extra_compile_args}: List of strings. Arguments for Make/C++
compiler. Example: \code{extra_compile_args =
      list("STAN_THREADS=true")} to enable threading.
\item Other compilation parameters: \code{filename}, \code{dims},
\code{coords}, \code{model_name}, \code{cleanup}.
}}
}
\value{
Nutpie trace object (Python object via reticulate).
}
\description{
Samples from a compiled Stan model using nutpie. This function
handles compilation, data conversion, and sampling.
}
\examples{
\dontrun{
stan_code <- "
data {
  int<lower=0> N;
  vector[N] y;
}
parameters {
  real mu;
}
model {
  mu ~ normal(0, 1);
  y ~ normal(mu, 1);
}
"
data_list <- list(N = 10L, y = rnorm(10))
trace <- nutpie_sample(stan_code, data_list,
                      num_chains = 4L,
                      num_samples = 1000L,
                      num_warmup = 500L,
                      seed = 12345L)
}

}
