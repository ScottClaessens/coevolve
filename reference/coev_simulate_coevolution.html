<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate the coevolution of multiple variables in discrete time steps — coev_simulate_coevolution • coevolve</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate the coevolution of multiple variables in discrete time steps — coev_simulate_coevolution"><meta name="description" content="This function simulates the coevolution of multiple continuous variables in
discrete time steps following a simple VAR(1) autoregressive model. Users set
the sample size, the variable names, the strength of selection and drift, and
the probability of a speciation event in a given time step. The function
returns a phylogeny, the results of the simulation run, and a dataset of
contemporary trait values."><meta property="og:description" content="This function simulates the coevolution of multiple continuous variables in
discrete time steps following a simple VAR(1) autoregressive model. Users set
the sample size, the variable names, the strength of selection and drift, and
the probability of a speciation event in a given time step. The function
returns a phylogeny, the results of the simulation run, and a dataset of
contemporary trait values."><meta property="og:image" content="https://scottclaessens.github.io/coevolve/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coevolve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9021</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/coevolve.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ScottClaessens/coevolve/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate the coevolution of multiple variables in discrete time steps</h1>
      <small class="dont-index">Source: <a href="https://github.com/ScottClaessens/coevolve/blob/main/R/coev_simulate_coevolution.R" class="external-link"><code>R/coev_simulate_coevolution.R</code></a></small>
      <div class="d-none name"><code>coev_simulate_coevolution.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function simulates the coevolution of multiple continuous variables in
discrete time steps following a simple VAR(1) autoregressive model. Users set
the sample size, the variable names, the strength of selection and drift, and
the probability of a speciation event in a given time step. The function
returns a phylogeny, the results of the simulation run, and a dataset of
contemporary trait values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">coev_simulate_coevolution</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">variables</span>,</span>
<span>  <span class="va">selection_matrix</span>,</span>
<span>  <span class="va">drift</span>,</span>
<span>  <span class="va">prob_split</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ancestral_states <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of data points in the resulting data frame.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>A character vector of variable names (e.g.,
<code>c("x","y")</code>)</p></dd>


<dt id="arg-selection-matrix">selection_matrix<a class="anchor" aria-label="anchor" href="#arg-selection-matrix"></a></dt>
<dd><p>A numeric matrix determining the strength of
selection between variables. The matrix must have a number of rows and
columns equal to the number of variables and its row and column names must
contain all specified variables. Each cell determines the strength of
selection from the column variable to the row variable. For example, the
cell on the "x" column and the "x" row indicates how much previous values
of x influence future values of x (autocorrelation). By contrast, the cell
on the "x" column and the "y" row indicates how much previous values of x
influence future values of y (cross-lagged effect).</p></dd>


<dt id="arg-drift">drift<a class="anchor" aria-label="anchor" href="#arg-drift"></a></dt>
<dd><p>A named numeric vector specifying the strength of drift for
different variables. Names must include all specified variables.</p></dd>


<dt id="arg-prob-split">prob_split<a class="anchor" aria-label="anchor" href="#arg-prob-split"></a></dt>
<dd><p>A numeric probability of a species split in any given
timestep.</p></dd>


<dt id="arg-intercepts">intercepts<a class="anchor" aria-label="anchor" href="#arg-intercepts"></a></dt>
<dd><p>Intercepts for the VAR(1) model. If NULL (default),
intercepts are set to zero for all variables. Otherwise, a named numeric
vector specifying the intercepts for different variables. Names must
include all specified variables.</p></dd>


<dt id="arg-ancestral-states">ancestral_states<a class="anchor" aria-label="anchor" href="#arg-ancestral-states"></a></dt>
<dd><p>Ancestral states for different variables. If NULL
(default), ancestral states are set to zero for all variables. Otherwise,
a named numeric vector specifying the ancestral states for different
variables. Names must include all specified variables.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List with dataset at final timestep (data), full simulation log
(simulation), and pruned phylogenetic tree (tree).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The model underlying this simulation is a simple VAR(1)
autoregressive model, where values of all variables at the previous
timestep predict values at the current timestep. In the case of two
variables, the model is as follows:
$$Y_t = \alpha_{y}+\beta_{y,y}Y_{t-1}+\beta_{y,x}X_{t-1} +
  \mathcal{N}(0,\epsilon_{y})$$
$$X_t = \alpha_{x}+\beta_{x,x}X_{t-1}+\beta_{x,y}Y_{t-1} +
  \mathcal{N}(0,\epsilon_{x})$$
where \(\alpha\) represents the intercepts, \(\beta\) represents the
selection matrix, and \(\epsilon\) represents the vector of drift
parameters. With some probability \(p\), a speciation event creates two
independent evolutionary branches. This simulation continues until the
intended sample size of species has been reached.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Scott Claessens <a href="mailto:scott.claessens@gmail.com">scott.claessens@gmail.com</a>, Erik Ringen
<a href="mailto:erikjacob.ringen@uzh.ch">erikjacob.ringen@uzh.ch</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># simulate coevolution of x and y</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># x -&gt; y but not vice versa</span></span></span>
<span class="r-in"><span><span class="va">selection_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">0.95</span>, <span class="fl">0.00</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.80</span>, <span class="fl">0.95</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">variables</span>, <span class="va">variables</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob_split</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="co"># run simulation</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">coev_simulate_coevolution</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">n</span>, <span class="va">variables</span>, <span class="va">selection_matrix</span>,</span></span>
<span class="r-in"><span>    <span class="va">drift</span>, <span class="va">prob_split</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Scott Claessens, Erik Ringen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

