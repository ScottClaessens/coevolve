<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Simulate the coevolution of multiple variables in discrete time steps — coev_simulate_coevolution • coevolve</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate the coevolution of multiple variables in discrete time steps — coev_simulate_coevolution"><meta property="og:description" content="This function simulates the coevolution of multiple continuous variables in
discrete time steps following a simple VAR(1) autoregressive model. Users set
the sample size, the variable names, the strength of selection and drift, and
the probability of a speciation event in a given time step. The function
returns a phylogeny, the results of the simulation run, and a dataset of
contemporary trait values."><meta property="og:image" content="https://scottclaessens.github.io/coevolve/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">coevolve</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/coevolve.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ScottClaessens/coevolve/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate the coevolution of multiple variables in discrete time steps</h1>
    <small class="dont-index">Source: <a href="https://github.com/ScottClaessens/coevolve/blob/main/R/coev_simulate_coevolution.R" class="external-link"><code>R/coev_simulate_coevolution.R</code></a></small>
    <div class="hidden name"><code>coev_simulate_coevolution.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function simulates the coevolution of multiple continuous variables in
discrete time steps following a simple VAR(1) autoregressive model. Users set
the sample size, the variable names, the strength of selection and drift, and
the probability of a speciation event in a given time step. The function
returns a phylogeny, the results of the simulation run, and a dataset of
contemporary trait values.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">coev_simulate_coevolution</span><span class="op">(</span></span>
<span>  <span class="va">n</span>,</span>
<span>  <span class="va">variables</span>,</span>
<span>  <span class="va">selection_matrix</span>,</span>
<span>  <span class="va">drift</span>,</span>
<span>  <span class="va">prob_split</span>,</span>
<span>  intercepts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ancestral_states <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of data points in the resulting data frame.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>A character vector of variable names (e.g.,
<code>c("x","y")</code>)</p></dd>


<dt id="arg-selection-matrix">selection_matrix<a class="anchor" aria-label="anchor" href="#arg-selection-matrix"></a></dt>
<dd><p>A numeric matrix determining the strength of
selection between variables. The matrix must have a number of rows and
columns equal to the number of variables and its row and column names must
contain all specified variables. Each cell determines the strength of
selection from the column variable to the row variable. For example, the
cell on the "x" column and the "x" row indicates how much previous values
of x influence future values of x (autocorrelation). By contrast, the cell
on the "x" column and the "y" row indicates how much previous values of x
influence future values of y (cross-lagged effect).</p></dd>


<dt id="arg-drift">drift<a class="anchor" aria-label="anchor" href="#arg-drift"></a></dt>
<dd><p>A named numeric vector specifying the strength of drift for
different variables. Names must include all specified variables.</p></dd>


<dt id="arg-prob-split">prob_split<a class="anchor" aria-label="anchor" href="#arg-prob-split"></a></dt>
<dd><p>A numeric probability of a species split in any given
timestep.</p></dd>


<dt id="arg-intercepts">intercepts<a class="anchor" aria-label="anchor" href="#arg-intercepts"></a></dt>
<dd><p>Intercepts for the VAR(1) model. If NULL (default),
intercepts are set to zero for all variables. Otherwise, a named numeric
vector specifying the intercepts for different variables. Names must
include all specified variables.</p></dd>


<dt id="arg-ancestral-states">ancestral_states<a class="anchor" aria-label="anchor" href="#arg-ancestral-states"></a></dt>
<dd><p>Ancestral states for different variables. If NULL
(default), ancestral states are set to zero for all variables. Otherwise,
a named numeric vector specifying the ancestral states for different
variables. Names must include all specified variables.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>List with dataset at final timestep (data), full simulation log
(simulation), and pruned phylogenetic tree (tree)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The model underlying this simulation is a simple VAR(1)
autoregressive model, where values of all variables at the previous
timestep predict values at the current timestep. In the case of two
variables, the model is as follows:
$$Y_t = \alpha_{y}+\beta_{y,y}Y_{t-1}+\beta_{y,x}X_{t-1} +
  \mathcal{N}(0,\epsilon_{y})$$
$$X_t = \alpha_{x}+\beta_{x,x}X_{t-1}+\beta_{x,y}Y_{t-1} +
  \mathcal{N}(0,\epsilon_{x})$$
where \(\alpha\) represents the intercepts, \(\beta\) represents the
selection matrix, and \(\epsilon\) represents the vector of drift
parameters. With some probability \(p\), a speciation event creates two
independent evolutionary branches. This simulation continues until the
intended sample size of species has been reached.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Scott Claessens <a href="mailto:scott.claessens@gmail.com">scott.claessens@gmail.com</a>, Erik Ringen
<a href="mailto:erikjacob.ringen@uzh.ch">erikjacob.ringen@uzh.ch</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># simulate coevolution of x and y</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># x -&gt; y but not vice versa</span></span></span>
<span class="r-in"><span><span class="va">selection_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fl">0.95</span>, <span class="fl">0.00</span>,</span></span>
<span class="r-in"><span>    <span class="fl">0.80</span>, <span class="fl">0.95</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  nrow <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">variables</span>, <span class="va">variables</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="st">"y"</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prob_split</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="co"># run simulation</span></span></span>
<span class="r-in"><span><span class="va">sim</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">coev_simulate_coevolution</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">n</span>, <span class="va">variables</span>, <span class="va">selection_matrix</span>,</span></span>
<span class="r-in"><span>    <span class="va">drift</span>, <span class="va">prob_split</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Scott Claessens, Erik Ringen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

